(()=>{"use strict";const e=document.getElementById("searchNav"),t=async(e,t)=>{try{await axios.post("http://localhost:3000/movies",e),alert("Pelicula creada correctamente")}catch(e){console.error("Error al enviar la película:",e),alert("Error al crear la película. Por favor, inténtelo de nuevo.")}},n=document.getElementById("section"),a=document.getElementById("form"),d=document.getElementById("submitBttn"),o=document.getElementById("searchNav"),s=document.getElementById("resetForm");n&&(async(e,t)=>{try{(()=>{const e=document.getElementById("section"),t=document.createElement("div");t.innerHTML='  <div class="progress-bar-container">\n    <div class="progress-bar stripes">\n      <span class="progress-bar-inner"></span>\n    </div>\n    \n  </div>',e.appendChild(t)})();const e=(await axios.get("http://localhost:3000/movies")).data;0===e.length||(e=>{const t=document.getElementById("section");t.innerHTML="";const n=document.createDocumentFragment();e.forEach(((e,t)=>{const{title:a,poster:d,year:o,director:s,genre:l,duration:c,rate:r}=e,i=document.createElement("div");i.className="card cardSize border m-3 p-2 pointer",i.dataset.bsToggle="modal",i.dataset.bsTarget=`#modal-${t}`;const m=document.createElement("h3");m.className="card-title text-center",m.innerText=a;const u=document.createElement("img");u.classList.add("mx-3"),u.src=d;const p=document.createElement("p");p.className="text-center p-2",p.innerText=`Publicada  en el año ${o}, dirigida por: "${s}". \n Generos:  ${l.join(", ")} \n Duracion: ${c} minutos \n Se lleva la califiacion de: \n ${r}`,i.appendChild(m),i.appendChild(u),i.appendChild(p),n.appendChild(i);const v=(({title:e,poster:t,year:n,director:a,genre:d,duration:o,rate:s})=>{const l=document.createElement("div");return l.className="modal fade",l.innerHTML=`\n    <div class="modal-dialog max-width-modal">\n      <div class="modal-content" >\n        <div class="modal-header text-bg-secondary">\n          <h3 class="modal-title ">${e}</h3>\n          <button type="button" class="btn-close bg-danger" data-bs-dismiss="modal" aria-label="Close"></button>\n        </div>\n        <div class="modal-body text-center" >\n          <img src="${t}" class="img-fluid mb-3 img-thumbnail" alt="Poster">\n          <p class="text-center"> Publicada en el año ${n}, dirigida por: "${a}".</p>\n          <p class="text-center">Géneros: ${d.join(", ")}</p>\n          <p class="text-center">Duración: ${o}</p>\n          <p class="text-center">Calificación: ${s}</p>\n        </div>\n      </div>\n    </div>\n  `,l})(e);v.id=`modal-${t}`,document.body.appendChild(v)})),t.appendChild(n)})(e)}catch{(()=>{const e=document.createElement("div");e.className="modal fade",e.innerHTML='\n    <div class="modal-dialog">\n      <div class="modal-content">\n        <div class="modal-header">\n          <h5 class="modal-title">¡Disculpe!</h5>\n          </div>\n          <div class="modal-body">\n          <p>El servidor está con inconvenientes. Intente recargar la página o luego mas tarde.</p>\n          </div>\n          <div class="modal-footer">\n          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>\n          <button type="button" class="btn btn-primary" data-bs-dismiss="modal" onclick="document.location.reload()">Reiniciar</button>\n          </div>\n      </div>\n    </div>\n  ',document.body.appendChild(e),new bootstrap.Modal(e).show(),setTimeout((()=>location.reload()),9e3)})()}})(),a?(d.addEventListener("click",(()=>{const e=document.getElementById("inputTitle").value,n=document.getElementById("inputDirector").value,a=parseInt(document.getElementById("inputYear").value,10),d=parseInt(document.getElementById("inputDuration").value,10),o=document.querySelectorAll(".ch:checked"),s=Array.from(o).map((e=>e.id)),l=document.getElementById("inputUrl").value,c=parseFloat((.1*document.getElementById("inputRate").value).toFixed(1)),r={title:e,director:n,year:a,duration:d,genre:s,poster:l,rate:c};return null==e||0==e.length||/^\s+$/.test(e)?(document.getElementById("basic-title").classList.remove("d-none"),alert("Error must introduce a valid title"),!1):isNaN(a)||a<1500||a>2100?(document.getElementById("basic-year").classList.remove("d-none"),document.getElementById("basic-title").classList.add("d-none"),alert("Error must introduce a valid year"),!1):null==n||0==n.length||/^\s+$/.test(n)?(document.getElementById("basic-direc").classList.remove("d-none"),document.getElementById("basic-year").classList.add("d-none"),alert("Error must introduce a valid Director`s name"),!1):isNaN(d)||d<10||d>500?(document.getElementById("basic-durac").classList.remove("d-none"),document.getElementById("basic-direc").classList.add("d-none"),alert("Error must introduce a valid duration"),!1):s.length<1?(document.getElementById("basic-genre").classList.remove("d-none"),document.getElementById("basic-durac").classList.add("d-none"),alert("Error, must select almost one genre"),!1):5===c?(document.getElementById("basic-rate").classList.remove("d-none"),document.getElementById("basic-genre").classList.add("d-none"),alert("Error, must select put a rate"),!1):l?(t(r),!0):(document.getElementById("basic-url").classList.remove("d-none"),document.getElementById("basic-rate").classList.add("d-none"),void alert("Error must introduce a valid poster url"))})),s.addEventListener("click",(()=>{document.querySelectorAll("div.form-text").forEach((e=>{e.classList.add("d-none")})),(()=>{const e=document.querySelectorAll("input[type=checkbox]").forEach((e=>e.checked=!1));console.log(e)})(),document.querySelectorAll("input").forEach((e=>{e.value=""}))}))):o.addEventListener("keyup",(()=>{const t=e.value.toLowerCase().trim();document.querySelectorAll(".card").forEach((e=>{e.querySelector("h3").innerText.toLowerCase().includes(t)?e.style.display="flex":e.style.display="none"}))}))})();